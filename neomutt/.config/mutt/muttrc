set folder          = imaps://imap.gmail.com
set imap_user       = "krivahtoo@gmail.com"
# Get password from 'pass' password manager
set imap_pass       = `pass mail`
set mailcap_path 	= ~/.mailcap
mailboxes           = +INBOX

# User
set realname = "Noah Too"
set from = "krivahtoo@gmail.com"

# Smtp settings
set smtp_url = "smtps://krivahtoo@smtp.gmail.com"
set smtp_pass = `pass mail`

# Folders
set spoolfile = +INBOX
# Specify where to save and/or look for postponed messages.
set postponed = +[Gmail]/Drafts
set trash     = +[Gmail]/Bin

# Gmail automatically saves sent e-mail to +[Gmail]/Sent, so we do not want duplicates.
unset record

# Store message headers locally to speed things up.
# If hcache is a folder, Mutt will create sub cache folders for each account which may speeds things up even more.
set header_cache = ~/.cache/mutt

# Store messages locally to speed things up, like searching message bodies.
# Can be the same folder as header_cache.
# This will cost important disk usage according to your e-mail amount.
set message_cachedir = "~/.cache/mutt"

# Allow Mutt to open a new IMAP connection automatically.
unset imap_passive

# Keep the IMAP connection alive by polling intermittently (time in seconds).
set imap_keepalive = 300

# How often to check for new mail (time in seconds).
set mail_check = 120

# Ensure TLS is enforced
set ssl_force_tls=no

set imap_check_subscribed

set sort=threads
# When sorting by threads, this variable controls how threads are sorted
# in relation to other threads, and how the branches of the thread trees are sorted.
set sort_aux=last-date-received
set sidebar_visible = yes
set sidebar_format = "%B%?F? [%F]?%* %?N?%N/?%S"
set mail_check_stats
# Index page format. Default "%4C %Z %{%b %d} %-15.15L (%?l?%4l&%4c?) %s"
set index_format="%4C %Z %<[y?%<[m?%<[d?%[%H:%M ]&%[%a %d]>&%[%b %d]>&%[%m/%y ]> %-15.15L (%?l?%4l&%4c?) %s"

set pager_format="-%Z- %C/%m: %-20.20n   %s%*  -- (%P)"

set status_format="-%r-NeoMutt: %D [Msgs:%?M?%M/?%m%?n? New:%n?%?o? Old:%o?%?d? Del:%d?%?F? Flag:%F?%?t? Tag:%t?%?p? Post:%p?%?b? Inc:%b?%?l? %l?]---(%?T?%T/?%s/%S)-%>-(%P)---"

set new_mail_command="notify-send --icon='/home/krivah/Pictures/mutt.png' \
'New Email' '%n new messages, %u unread.' -a 'Neomutt' &"

set editor="nvim"

auto_view text/html

alternative_order text/plain text/html

# disable g binding to enable sequence binding
bind attach,index,pager g noop

macro index gd "<change-folder>$postponed<enter>" "go to drafts"
macro index gs "<change-folder>$record<enter>" "go to sent"
macro index gi "<change-folder>$spoolfile<Enter>" "go to inbox"
macro index gt "<change-folder>$trash<enter>" "go to trash""

# Vim like binds
bind attach,index,pager \CD next-page
bind attach,index,pager \CU previous-page
bind pager gg top
bind pager G bottom
bind attach,index gg first-entry
bind attach,index G last-entry

bind pager <Up> previous-page
bind pager <Down> next-page
bind pager j next-line
bind pager k previous-line

macro attach o \
"\
<enter-command>unset wait_key<enter>\
<shell-escape>rm -f /tmp/mutt-attach<enter>\
<save-entry><kill-line>/tmp/mutt-attach<enter>\
<shell-escape> /tmp/mutt-attach &^A\
" "open an attachment with"

bind index z noop
bind index zb current-bottom
bind index zt current-top
bind index zz current-middle

bind index \\ search-opposite

# Sidebar binds
bind index,pager \CP sidebar-prev                 # Ctrl-n to select next folder
bind index,pager \CN sidebar-next                 # Ctrl-p to select previous folder
bind index,pager \CO sidebar-open                 # Ctrl-o to open selected folder
bind index,pager \CH sidebar-toggle-visible       # Ctrl-h to toggle visibility of the sidebar

bind editor <Tab> complete-query

macro index,pager \cb \
"<pipe-message> \
urlscan -dc -f 'dmenuhandler {}'<Enter>" \
"call urlscan to extract URLs out of a message"

macro compose Y "<first-entry>\
<pipe-entry>convert-multipart<enter>\
<enter-command>source /tmp/neomutt-commands<enter>"\
"convert to multipart email"

# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
#
# Color definitions
#
source colors.muttrc

